{% extends "PlantnetDataBundle::layout.html.twig" %}
{% block head %}
  {% block stylesheets %}
    {{ parent() }}
    {#{{ vichgeo_include_css() }}#}
    {# leaflet_css #}
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.css" />
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
    <![endif]-->
    <link rel="stylesheet" href="{{ asset('bundles/plantnetdata/css/leaflet/marker_cluster/MarkerCluster.css') }}" />
    <link rel="stylesheet" href="{{ asset('bundles/plantnetdata/css/leaflet/marker_cluster/MarkerCluster.Default.css') }}" />
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="{{ asset('bundles/plantnetdata/css/leaflet/marker_cluster/MarkerCluster.Default.ie.css') }}" />
    <![endif]-->
    <style type="text/css">
      #map{
        width:600px;
        height:400px;
      }
    </style>
    {# /leaflet_css #}
  {% endblock %}
  <title>{% block title module.Name%}</title>
  {#{{ vichgeo_include_js() }}#}
  {#
  <script type="text/javascript" src="{{ asset('bundles/plantnetdata/js/MarkerClusterer-1.0/src/markerclusterer.js') }}"></script>
  <script type="text/javascript">
    function initialize() {
      var markerCluster = new MarkerClusterer(map);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
  </script>
  #}
{% endblock %}
{% block main %}
  <section id="breadcrumbs">
    <a href="{{ path('_collection', { 'collection': collection.Name }) }}">{{ collection.Name }}</a>
    >>
    <a href="{{ path('_module', { 'collection': collection.Name, 'module': module.Name }) }}">{{ module.Name }}</a>
  </section>
  {#{{ vichgeo_map('location') }}#}
  {# leaflet_map #}
  <div id="map"></div>
  {# /leaflet_map #}
{% endblock %}
{% block javascripts %}
  {{ parent() }}
  {# leaflet_js #}
  <script src="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.js"></script>
  <script type="text/javascript" src="{{ asset('bundles/plantnetdata/js/leaflet/marker_cluster/leaflet.markercluster.js') }}"></script>
  <script type="text/javascript">
    var map=L.map('map',{
      center:[0,0],
      zoom:1
    });
    var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
    var osmAttrib='Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
    var osm=new L.TileLayer(osmUrl,{attribution:osmAttrib});
    map.addLayer(osm);
    var markers=new L.MarkerClusterGroup({
      showCoverageOnHover:false
    });
    {% for location in locations %}
      var marker_{{ location.getId() }}=L.marker([{{ location.getLatitude() }},{{ location.getLongitude() }}]);
      marker_{{ location.getId() }}.bindPopup('<b>{{ location.getProperty().Taxon }}</b><br />{{ location.getProperty().Family }}');
      markers.addLayer(marker_{{ location.getId() }});
    {% endfor %}
    map.addLayer(markers);
  </script>
  {# /leaflet_js #}
{% endblock %}